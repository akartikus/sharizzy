<ion-header>
  <ion-toolbar>
    <ion-title>Ma liste de courses</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="home-content">
  @if (!isLoading) {
    <div class="page-wrapper">
      <!-- Infos utilisateur / liste -->
      <app-user-info [pseudo]="pseudo" [listId]="listId"></app-user-info>

      <!-- Ajout d'un nouvel article -->
      <app-add-item-form (itemAdded)="onItemAdded($event)"></app-add-item-form>

      <!-- Liste des items -->
      <ion-list inset="true" class="items-list" lines="none">
        @for (item of (items$ | async) ?? []; track item.id) {
          <div class="item-wrapper">
            <app-shopping-item
              [item]="item"
              (toggle)="onItemToggle($event)"
              (delete)="onItemDelete($event)"
            ></app-shopping-item>
          </div>
        }

        <!-- Message si la liste est vide -->
        @if ((items$ | async)?.length === 0) {
          <ion-item lines="none">
            <ion-label class="empty-label">
              Ta liste est vide, ajoute ton premier article ðŸ™‚
            </ion-label>
          </ion-item>
        }
      </ion-list>
    </div>
  } @else {
    <!-- Ã‰tat de chargement -->
    <div class="loading-wrapper ion-text-center">
      <ion-spinner></ion-spinner>
      <p>Chargement...</p>
    </div>
  }

  <!-- Toast d'erreur -->
  <ion-toast
    [isOpen]="toastErrorOpen"
    [message]="errorMessage ?? ''"
    (didDismiss)="toastErrorOpen = false"
    duration="3500"
    color="danger"
    position="bottom"
  ></ion-toast>
</ion-content>